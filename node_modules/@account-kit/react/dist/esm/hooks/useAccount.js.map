{"version":3,"file":"useAccount.js","sourceRoot":"","sources":["../../../src/hooks/useAccount.ts"],"names":[],"mappings":"AAAA,YAAY,CAAC;AAEb,OAAO,EACL,aAAa,EACb,UAAU,EACV,YAAY,GAKb,MAAM,mBAAmB,CAAC;AAC3B,OAAO,EAAE,WAAW,EAAE,MAAM,uBAAuB,CAAC;AACpD,OAAO,EAAE,SAAS,EAAE,oBAAoB,EAAE,MAAM,OAAO,CAAC;AAExD,OAAO,EAAE,wBAAwB,EAAE,MAAM,+BAA+B,CAAC;AAEzE,OAAO,EAAE,eAAe,EAAE,MAAM,sBAAsB,CAAC;AAgBvD;;;;;;;;;;;;;;;;;;;;GAoBG;AACH,MAAM,UAAU,UAAU,CACxB,MAAiC;IAEjC,MAAM,EAAE,IAAI,EAAE,aAAa,EAAE,UAAU,EAAE,GAAG,YAAY,EAAE,GAAG,MAAM,CAAC;IACpE,MAAM,EAAE,MAAM,EAAE,WAAW,EAAE,GAAG,wBAAwB,EAAE,CAAC;IAC3D,MAAM,MAAM,GAAG,eAAe,EAAE,CAAC;IACjC,MAAM,OAAO,GAAG,oBAAoB,CAClC,YAAY,CAAC,IAAI,EAAE,MAAM,CAAC,EAC1B,GAAG,EAAE,CAAC,UAAU,CAAC,MAAM,EAAE,MAAM,CAAC,EAChC,GAAG,EAAE,CAAC,UAAU,CAAC,MAAM,EAAE,MAAM,CAAC,CACjC,CAAC;IAEF,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,GAAG,WAAW,CACvC;QACE,UAAU,EAAE,KAAK,IAAI,EAAE;YACrB,IAAI,OAAO,CAAC,MAAM,KAAK,cAAc,IAAI,OAAO,EAAE,OAAO,EAAE,CAAC;gBAC1D,OAAO,OAAO,CAAC,OAAO,CAAC;YACzB,CAAC;YAED,OAAO,aAAa,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;QACvC,CAAC;QACD,WAAW,EAAE,CAAC,eAAe,EAAE,IAAI,CAAC;QACpC,GAAG,YAAY;KAChB,EACD,WAAW,CACZ,CAAC;IAEF,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,CAAC,UAAU,IAAI,MAAM,CAAC,WAAW,IAAI,CAAC,OAAO,EAAE,OAAO,IAAI,CAAC,SAAS,EAAE,CAAC;YACzE,MAAM,EAAE,CAAC;QACX,CAAC;IACH,CAAC,EAAE,CAAC,OAAO,EAAE,SAAS,EAAE,MAAM,EAAE,UAAU,EAAE,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC;IAEjE,OAAO;QACL,OAAO,EAAE,OAAO,CAAC,MAAM,KAAK,OAAO,CAAC,CAAC,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC,SAAS;QAClE,OAAO,EACL,OAAO,CAAC,MAAM,KAAK,cAAc,IAAI,OAAO,CAAC,MAAM,KAAK,OAAO;YAC7D,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO;YACzB,CAAC,CAAC,SAAS;QACf,gBAAgB,EACd,SAAS;YACT,OAAO,EAAE,MAAM,KAAK,cAAc;YAClC,OAAO,EAAE,MAAM,KAAK,cAAc;YAClC,MAAM,CAAC,gBAAgB;YACvB,MAAM,CAAC,cAAc;KACxB,CAAC;AACJ,CAAC","sourcesContent":["\"use client\";\n\nimport {\n  createAccount,\n  getAccount,\n  watchAccount,\n  type GetAccountParams,\n  type SupportedAccount,\n  type SupportedAccounts,\n  type SupportedAccountTypes,\n} from \"@account-kit/core\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useEffect, useSyncExternalStore } from \"react\";\nimport type { Address } from \"viem\";\nimport { useAlchemyAccountContext } from \"./useAlchemyAccountContext.js\";\nimport type { BaseHookMutationArgs } from \"../types.js\";\nimport { useSignerStatus } from \"./useSignerStatus.js\";\n\nexport type UseAccountMutationArgs<TAccount extends SupportedAccountTypes> =\n  BaseHookMutationArgs<SupportedAccount<TAccount> | SupportedAccounts, void>;\n\nexport type UseAccountResult<TAccount extends SupportedAccountTypes> = {\n  account?: SupportedAccount<TAccount>;\n  address?: Address;\n  isLoadingAccount: boolean;\n};\n\nexport type UseAccountProps<TAccount extends SupportedAccountTypes> =\n  GetAccountParams<TAccount> & {\n    skipCreate?: boolean;\n  } & UseAccountMutationArgs<TAccount>;\n\n/**\n * [Hook](https://github.com/alchemyplatform/aa-sdk/blob/main/account-kit/react/src/hooks/useAccount.ts) to subscribe to account state and interactions, including creation, connection, and status monitoring. It synchronizes with external store updates and provides status-dependent results.\n * The supported account types are: LightAccount, MultiOwnerLightAccount, MultiOwnerModularAccount, and ModularAccountV2. Primarily used to get the smart account address before deployment. Dependent on the signer: if the signer has not been initialized and authenticated, `address` and `isLoadingAccount` return null.\n *\n * If using a smart contract account, returns instance of a smart contract account that the user is connected to. Returns address of smart contract account, not address of the signer.\n *\n * If using an EOA, returns address of signer\n *\n * @template {SupportedAccountTypes} TAccount The type of account to use\n * @param {UseAccountProps<TAccount>} params The parameters required for account management, including account type, specific account parameters, and optional mutation arguments. [ref](https://github.com/alchemyplatform/aa-sdk/blob/main/account-kit/react/src/hooks/useAccount.ts#L28)\n * @returns {UseAccountResult<TAccount>} An object containing the account information, address, and loading state. [ref](https://github.com/alchemyplatform/aa-sdk/blob/main/account-kit/react/src/hooks/useAccount.ts#L22)\n *\n * @example\n * ```ts twoslash\n * import { useAccount } from \"@account-kit/react\";\n *\n * const { account, address, isLoadingAccount } = useAccount({\n *  type: \"LightAccount\"\n * });\n * ```\n */\nexport function useAccount<TAccount extends SupportedAccountTypes>(\n  params: UseAccountProps<TAccount>\n): UseAccountResult<TAccount> {\n  const { type, accountParams, skipCreate, ...mutationArgs } = params;\n  const { config, queryClient } = useAlchemyAccountContext();\n  const status = useSignerStatus();\n  const account = useSyncExternalStore(\n    watchAccount(type, config),\n    () => getAccount(params, config),\n    () => getAccount(params, config)\n  );\n\n  const { mutate, isPending } = useMutation(\n    {\n      mutationFn: async () => {\n        if (account.status !== \"RECONNECTING\" && account?.account) {\n          return account.account;\n        }\n\n        return createAccount(params, config);\n      },\n      mutationKey: [\"createAccount\", type],\n      ...mutationArgs,\n    },\n    queryClient\n  );\n\n  useEffect(() => {\n    if (!skipCreate && status.isConnected && !account?.account && !isPending) {\n      mutate();\n    }\n  }, [account, isPending, mutate, skipCreate, status.isConnected]);\n\n  return {\n    account: account.status === \"READY\" ? account?.account : undefined,\n    address:\n      account.status === \"RECONNECTING\" || account.status === \"READY\"\n        ? account.account.address\n        : undefined,\n    isLoadingAccount:\n      isPending ||\n      account?.status === \"INITIALIZING\" ||\n      account?.status === \"RECONNECTING\" ||\n      status.isAuthenticating ||\n      status.isInitializing,\n  };\n}\n"]}