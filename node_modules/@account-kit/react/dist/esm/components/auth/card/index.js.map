{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../../src/components/auth/card/index.tsx"],"names":[],"mappings":"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","sourcesContent":["\"use client\";\n\nimport { disconnect } from \"@account-kit/core\";\nimport {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  type PropsWithChildren,\n} from \"react\";\nimport { useAlchemyAccountContext } from \"../../../hooks/useAlchemyAccountContext.js\";\nimport { useAuthConfig } from \"../../../hooks/internal/useAuthConfig.js\";\nimport { useAuthModal } from \"../../../hooks/useAuthModal.js\";\nimport { useElementHeight } from \"../../../hooks/useElementHeight.js\";\nimport { useSignerStatus } from \"../../../hooks/useSignerStatus.js\";\nimport { Navigation } from \"../../navigation.js\";\nimport { useAuthContext } from \"../context.js\";\nimport { Footer } from \"../sections/Footer.js\";\nimport { Step } from \"./steps.js\";\nexport type AuthCardProps = {\n  className?: string;\n};\n\n/**\n * React component containing an Auth view with configured auth methods\n * and options based on the config passed to the AlchemyAccountProvider\n *\n * @example\n * ```tsx\n * import { AuthCard, useAlchemyAccountContext } from \"@account-kit/react\";\n *\n * function ComponentWithAuthCard() {\n *  // assumes you've passed in a UI config to the Account Provider\n *  // you can also directly set the properties on the AuthCard component\n *  const { uiConfig } = useAlchemyAccountContext();\n *\n *  return (\n *    <AuthCard { ...uiConfig!.auth } />\n *  );\n * }\n * ```\n *\n * @param {AuthCardProps} props Card Props\n * @returns {JSX.Element} a react component containing the AuthCard\n */\nexport const AuthCard = (props: AuthCardProps) => {\n  return <AuthCardContent {...props} />;\n};\n\n// this isn't used externally\n// eslint-disable-next-line jsdoc/require-jsdoc\nexport const AuthCardContent = ({\n  className,\n  showClose = false,\n}: {\n  className?: string;\n  showClose?: boolean;\n}) => {\n  const { openAuthModal, closeAuthModal } = useAuthModal();\n  const { status, isAuthenticating, isConnected } = useSignerStatus();\n  const { authStep, setAuthStep } = useAuthContext();\n  const { config } = useAlchemyAccountContext();\n\n  const didGoBack = useRef(false);\n\n  const { onAuthSuccess, addPasskeyOnSignup } = useAuthConfig(\n    ({ onAuthSuccess, addPasskeyOnSignup }) => ({\n      onAuthSuccess,\n      addPasskeyOnSignup,\n    })\n  );\n\n  const canGoBack = useMemo(() => {\n    return [\n      \"email_verify\",\n      \"otp_verify\",\n      \"passkey_verify\",\n      \"passkey_create\",\n      \"pick_eoa\",\n      \"wallet_connect\",\n      \"eoa_connect\",\n      \"oauth_completing\",\n    ].includes(authStep.type);\n  }, [authStep]);\n\n  const onBack = useCallback(() => {\n    switch (authStep.type) {\n      case \"email_verify\":\n      case \"otp_verify\":\n      case \"passkey_verify\":\n      case \"passkey_create\":\n      case \"oauth_completing\":\n        disconnect(config); // Terminate any inflight authentication\n        didGoBack.current = true;\n        setAuthStep({ type: \"initial\" });\n        break;\n      case \"wallet_connect\":\n      case \"eoa_connect\":\n        setAuthStep({ type: \"pick_eoa\" });\n        break;\n      case \"pick_eoa\":\n        setAuthStep({ type: \"initial\" });\n        break;\n      default:\n        console.warn(\"Unhandled back action for auth step\", authStep);\n    }\n  }, [authStep, setAuthStep, config]);\n\n  const onClose = useCallback(() => {\n    if (!isConnected) {\n      // Terminate any inflight authentication\n      disconnect(config);\n    }\n\n    if (authStep.type === \"passkey_create\") {\n      setAuthStep({ type: \"complete\" });\n    } else {\n      setAuthStep({ type: \"initial\" });\n    }\n    closeAuthModal();\n  }, [isConnected, authStep.type, closeAuthModal, config, setAuthStep]);\n\n  useEffect(() => {\n    if (authStep.type === \"complete\") {\n      didGoBack.current = false;\n      closeAuthModal();\n      onAuthSuccess?.();\n    } else if (authStep.type !== \"initial\") {\n      didGoBack.current = false;\n    }\n  }, [\n    authStep,\n    status,\n    isAuthenticating,\n    setAuthStep,\n    onAuthSuccess,\n    openAuthModal,\n    closeAuthModal,\n    addPasskeyOnSignup,\n    isConnected,\n  ]);\n\n  return (\n    <div className=\"flex flex-col relative\">\n      {/* Wrapper container that sizes its height dynamically */}\n      <DynamicHeight>\n        {(canGoBack || showClose) && (\n          <Navigation\n            showClose={showClose}\n            showBack={canGoBack}\n            onBack={onBack}\n            onClose={onClose}\n          />\n        )}\n        <div\n          className={`max-h-[60vh] overflow-auto relative flex flex-col items-center gap-4 text-fg-primary px-6 py-4 ${\n            className ?? \"\"\n          }`}\n        >\n          <Step />\n        </div>\n        <Footer authStep={authStep} />\n      </DynamicHeight>\n    </div>\n  );\n};\n\nconst DynamicHeight = ({ children }: PropsWithChildren) => {\n  const contentRef = useRef<HTMLDivElement>(null);\n  const { height } = useElementHeight(contentRef);\n\n  return (\n    <div\n      className=\"transition-[flex-basis] duration-200 ease-out overflow-y-hidden radius-2\"\n      style={{\n        flexBasis: height ? `${height}px` : undefined,\n      }}\n    >\n      <div className=\"z-[1]\" ref={contentRef}>\n        {children}\n      </div>\n    </div>\n  );\n};\n"]}