{"version":3,"file":"watchAccount.js","sourceRoot":"","sources":["../../../src/actions/watchAccount.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,uBAAuB,EAAE,MAAM,cAAc,CAAC;AAEvD,OAAO,EAAyB,MAAM,iBAAiB,CAAC;AACxD,OAAO,EAAE,QAAQ,EAAE,MAAM,eAAe,CAAC;AAEzC;;;;;;;;;;;;;;;;GAgBG;AACH,MAAM,CAAC,MAAM,YAAY,GACvB,CACE,IAAc,EACd,MAA6B,EAC7B,EAAE,CACJ,CAAC,QAAuD,EAAE,EAAE;IAC1D,MAAM,QAAQ,GAAG,MAAM,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,QAAQ,CAAC;IAClD,IAAI,CAAC,QAAQ,EAAE,CAAC;QACd,MAAM,IAAI,uBAAuB,CAAC,SAAS,CAAC,CAAC;IAC/C,CAAC;IAED,MAAM,KAAK,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC;IAC/B,OAAO,MAAM,CAAC,KAAK,CAAC,SAAS;IAC3B,wEAAwE;IACxE,CAAC,EAAE,QAAQ,EAAE,EAAE,EAAE,CAAC,QAAS,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,EAC3C,QAAQ,EACR;QACE,UAAU,CAAC,CAAC,EAAE,CAAC;YACb,OAAO,CAAC,EAAE,MAAM,KAAK,OAAO,IAAI,CAAC,EAAE,MAAM,KAAK,OAAO;gBACnD,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,KAAK,CAAC,CAAC,OAAO,CAAC,OAAO;gBACzC,CAAC,CAAC,CAAC,EAAE,MAAM,KAAK,CAAC,EAAE,MAAM,CAAC;QAC9B,CAAC;KACF,CACF,CAAC;AACJ,CAAC,CAAC","sourcesContent":["import { ClientOnlyPropertyError } from \"../errors.js\";\nimport type { AlchemyAccountsConfig, SupportedAccountTypes } from \"../types.js\";\nimport { type GetAccountResult } from \"./getAccount.js\";\nimport { getChain } from \"./getChain.js\";\n\n/**\n * Watches for changes to a specific type of account and triggers the provided callback function when changes occur.\n *\n * @example\n * ```ts\n * import { watchAccount } from \"@account-kit/core\";\n * // see createConfig for more information on how to create a config\n * import { config } from \"./config\";\n *\n * watchAccount(\"LightAccount\", config)(console.log);\n * ```\n *\n * @template TAccount The type of account to watch\n * @param {TAccount} type The type of account to watch\n * @param {AlchemyAccountsConfig} config The configuration containing client store settings\n * @returns {(onChange: (account: GetAccountResult<TAccount>) => void) => (() => void)} A function that accepts a callback to be called when the account changes and returns a function to unsubscribe from the store\n */\nexport const watchAccount =\n  <TAccount extends SupportedAccountTypes>(\n    type: TAccount,\n    config: AlchemyAccountsConfig\n  ) =>\n  (onChange: (account: GetAccountResult<TAccount>) => void) => {\n    const accounts = config.store.getState().accounts;\n    if (!accounts) {\n      throw new ClientOnlyPropertyError(\"account\");\n    }\n\n    const chain = getChain(config);\n    return config.store.subscribe(\n      // this should be available on the client now because of the check above\n      ({ accounts }) => accounts![chain.id][type],\n      onChange,\n      {\n        equalityFn(a, b) {\n          return a?.status === \"READY\" && b?.status === \"READY\"\n            ? a.account.address === b.account.address\n            : a?.status === b?.status;\n        },\n      }\n    );\n  };\n"]}