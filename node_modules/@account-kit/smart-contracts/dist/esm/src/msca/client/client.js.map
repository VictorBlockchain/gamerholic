{"version":3,"file":"client.js","sourceRoot":"","sources":["../../../../../src/msca/client/client.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  createSmartAccountClient,\n  smartAccountClientActions,\n  type NotType,\n  type SmartAccountClient,\n  type SmartAccountClientRpcSchema,\n  type SmartAccountSigner,\n} from \"@aa-sdk/core\";\nimport { type Chain, type CustomTransport, type Transport } from \"viem\";\nimport type { CreateLightAccountClientParams } from \"../../light-account/clients/client.js\";\nimport {\n  accountLoupeActions,\n  type AccountLoupeActions,\n} from \"../account-loupe/decorator.js\";\nimport {\n  createMultiOwnerModularAccount,\n  type CreateMultiOwnerModularAccountParams,\n  type MultiOwnerModularAccount,\n} from \"../account/multiOwnerAccount.js\";\nimport {\n  createMultisigModularAccount,\n  type CreateMultisigModularAccountParams,\n  type MultisigModularAccount,\n} from \"../account/multisigAccount.js\";\nimport {\n  pluginManagerActions,\n  type PluginManagerActions,\n} from \"../plugin-manager/decorator.js\";\nimport {\n  multiOwnerPluginActions,\n  type MultiOwnerPluginActions,\n} from \"../plugins/multi-owner/index.js\";\nimport {\n  multisigPluginActions,\n  type MultisigPluginActions,\n  type MultisigUserOperationContext,\n} from \"../plugins/multisig/index.js\";\nimport { multisigSignatureMiddleware } from \"../plugins/multisig/middleware.js\";\nimport type { AlchemyModularAccountClientConfig } from \"./alchemyClient.js\";\nimport {\n  createAlchemySmartAccountClient,\n  isAlchemyTransport,\n  type AlchemySmartAccountClient,\n  type AlchemyTransport,\n} from \"@account-kit/infra\";\nimport type { AlchemyMultisigAccountClientConfig } from \"./multiSigAlchemyClient.js\";\n\nexport type CreateMultiOwnerModularAccountClientWithoutAlchemyParams<\n  TTransport extends Transport = Transport,\n  TChain extends Chain | undefined = Chain | undefined,\n  TSigner extends SmartAccountSigner = SmartAccountSigner\n> = Omit<\n  CreateMultiOwnerModularAccountParams<TTransport, TSigner>,\n  \"transport\" | \"chain\"\n> &\n  Omit<CreateLightAccountClientParams<TTransport, TChain, TSigner>, \"account\">;\nexport type CreateMultiOwnerModularAccountClientParams<\n  TTransport extends Transport = Transport,\n  TChain extends Chain | undefined = Chain | undefined,\n  TSigner extends SmartAccountSigner = SmartAccountSigner\n> =\n  | CreateMultiOwnerModularAccountClientWithoutAlchemyParams<\n      TTransport,\n      TChain,\n      TSigner\n    >\n  | AlchemyModularAccountClientConfig<TSigner>;\n\nexport type CreateMultisigModularAccountClientWithoutAlchemyParams<\n  TTransport extends Transport = Transport,\n  TChain extends Chain | undefined = Chain | undefined,\n  TSigner extends SmartAccountSigner = SmartAccountSigner\n> = Omit<\n  CreateMultisigModularAccountParams<TTransport, TSigner>,\n  \"transport\" | \"chain\"\n> &\n  Omit<CreateLightAccountClientParams<TTransport, TChain, TSigner>, \"account\">;\n\nexport type CreateMultisigModularAccountClientParams<\n  TTransport extends Transport = Transport,\n  TChain extends Chain | undefined = Chain | undefined,\n  TSigner extends SmartAccountSigner = SmartAccountSigner\n> =\n  | CreateMultisigModularAccountClientWithoutAlchemyParams<\n      TTransport,\n      TChain,\n      TSigner\n    >\n  | AlchemyMultisigAccountClientConfig<TSigner>;\n\nexport function createMultiOwnerModularAccountClient<\n  TSigner extends SmartAccountSigner = SmartAccountSigner\n>(\n  params: AlchemyModularAccountClientConfig<TSigner> & {\n    transport: AlchemyTransport;\n  }\n): Promise<\n  AlchemySmartAccountClient<\n    Chain | undefined,\n    MultiOwnerModularAccount<TSigner>,\n    MultiOwnerPluginActions<MultiOwnerModularAccount<TSigner>> &\n      PluginManagerActions<MultiOwnerModularAccount<TSigner>> &\n      AccountLoupeActions<MultiOwnerModularAccount<TSigner>>\n  >\n>;\n\nexport function createMultiOwnerModularAccountClient<\n  TTransport extends Transport = Transport,\n  TChain extends Chain | undefined = Chain | undefined,\n  TSigner extends SmartAccountSigner = SmartAccountSigner\n>(\n  args: CreateMultiOwnerModularAccountClientParams<\n    TTransport,\n    TChain,\n    TSigner\n  > &\n    NotType<TTransport, AlchemyTransport>\n): Promise<\n  SmartAccountClient<\n    CustomTransport,\n    Chain,\n    MultiOwnerModularAccount<TSigner>,\n    MultiOwnerPluginActions<MultiOwnerModularAccount<TSigner>> &\n      PluginManagerActions<MultiOwnerModularAccount<TSigner>> &\n      AccountLoupeActions<MultiOwnerModularAccount<TSigner>>\n  >\n>;\n\n/**\n * Creates a multi-owner modular account client with the provided parameters including account, transport, chain, and additional client configuration. This function uses a modular account and extends it with various plugin actions.\n *\n * @example\n * ```ts\n * import { createMultiOwnerModularAccountClient } from \"@account-kit/smart-contracts\";\n * import { LocalAccountSigner } from \"@aa-sdk/core\";\n * import { sepolia } from \"viem/chains\";\n * import { http } from \"viem\";\n * import { generatePrivateKey } from \"viem/accounts\";\n *\n * const accountClient = await createMultiOwnerModularAccountClient({\n *  chain: sepolia,\n *  transport: http(\"RPC_URL\"),\n *  signer: LocalAccountSigner.privateKeyToAccountSigner(generatePrivateKey())\n * });\n * ```\n * @example\n * ```ts\n * import { createMultiOwnerModularAccountClient } from \"@account-kit/smart-contracts\";\n * import { sepolia, alchemy } from \"@account-kit/infra\";\n * import { LocalAccountSigner } from \"@aa-sdk/core\";\n * import { generatePrivateKey } from \"viem\"\n *\n * const alchemyAccountClient = await createMultiOwnerModularAccountClient({\n *  transport: alchemy({ apiKey: \"your-api-key\" }),\n *  chain: sepolia,\n *  signer: LocalAccountSigner.privateKeyToAccountSigner(generatePrivateKey())\n * });\n * ```\n *\n * @param {CreateMultiOwnerModularAccountClientParams} config The parameters for creating the multi-owner modular account client\n * @returns {Promise<SmartAccountClient>} A promise that resolves to a `SmartAccountClient` instance with extended plugin actions\n */\nexport async function createMultiOwnerModularAccountClient({\n  transport,\n  chain,\n  ...params\n}: CreateMultiOwnerModularAccountClientParams): Promise<\n  SmartAccountClient | AlchemySmartAccountClient\n> {\n  const modularAccount = await createMultiOwnerModularAccount({\n    ...params,\n    transport,\n    chain,\n  });\n  if (isAlchemyTransport(transport, chain)) {\n    const { opts } = params;\n\n    return createAlchemySmartAccountClient({\n      ...params,\n      account: modularAccount,\n      transport,\n      chain,\n      opts,\n    })\n      .extend(multiOwnerPluginActions)\n      .extend(pluginManagerActions)\n      .extend(accountLoupeActions);\n  }\n\n  return createSmartAccountClient({\n    ...params,\n    transport,\n    chain,\n    account: modularAccount,\n  })\n    .extend(pluginManagerActions)\n    .extend(multiOwnerPluginActions)\n    .extend(accountLoupeActions);\n}\n\nexport function createMultisigModularAccountClient<\n  TSigner extends SmartAccountSigner = SmartAccountSigner\n>(\n  params: AlchemyMultisigAccountClientConfig<TSigner>\n): Promise<\n  AlchemySmartAccountClient<\n    Chain | undefined,\n    MultisigModularAccount<TSigner>,\n    MultisigPluginActions<MultisigModularAccount<TSigner>> &\n      PluginManagerActions<MultisigModularAccount<TSigner>> &\n      AccountLoupeActions<MultisigModularAccount<TSigner>>,\n    MultisigUserOperationContext\n  >\n>;\n\nexport function createMultisigModularAccountClient<\n  TTransport extends Transport = Transport,\n  TChain extends Chain | undefined = Chain | undefined,\n  TSigner extends SmartAccountSigner = SmartAccountSigner\n>(\n  args: CreateMultisigModularAccountClientParams<TTransport, TChain, TSigner> &\n    NotType<TTransport, AlchemyTransport>\n): Promise<\n  SmartAccountClient<\n    CustomTransport,\n    Chain,\n    MultisigModularAccount<TSigner>,\n    MultisigPluginActions<MultisigModularAccount<TSigner>> &\n      PluginManagerActions<MultisigModularAccount<TSigner>> &\n      AccountLoupeActions<MultisigModularAccount<TSigner>>,\n    SmartAccountClientRpcSchema,\n    MultisigUserOperationContext\n  >\n>;\n\n/**\n * Creates a multisig modular account client using the provided parameters including account details, transport, chain, and additional client configuration. This function constructs the multisig modular account and extends it with various actions to create a comprehensive client.\n *\n * @example\n * ```ts\n * import { createMultisigModularAccountClient } from \"@account-kit/smart-contracts\";\n * import { LocalAccountSigner } from \"@aa-sdk/core\";\n * import { sepolia } from \"viem/chains\";\n * import { http } from \"viem\"\n * import { generatePrivateKey } from \"viem/accounts\";\n *\n * const accountClient = await createMultisigModularAccountClient({\n *  chain: sepolia,\n *  transport: http(\"RPC_URL\"),\n *  signer: LocalAccountSigner.privateKeyToAccountSigner(generatePrivateKey()),\n *  owners: [], // other owners on the account\n *  threshold: 2, // 2 of N signatures\n * });\n * ```\n * @example\n * ```ts\n * import { createMultisigModularAccountClient } from \"@account-kit/smart-contracts\";\n * import { sepolia } from \"@account-kit/infra\";\n * import { LocalAccountSigner } from \"@aa-sdk/core\";\n * import { generatePrivateKey } from \"viem\"\n *\n * const alchemyAccountClient = await createMultisigModularAccountClient({\n *  transport: alchemy({ apiKey: \"your-api-key\" }),\n *  chain: sepolia,\n *  signer: LocalAccountSigner.privateKeyToAccountSigner(generatePrivateKey()),\n *  owners: [...], // other owners on the account\n *  threshold: 2, // 2 of N signatures\n * });\n * ```\n *\n * @param {CreateMultisigModularAccountClientParams} config the parameters for configuring the multisig modular account client\n * @returns {Promise<SmartAccountClient<Transport, Chain, MultisigModularAccount<SmartAccountSigner>, {}, SmartAccountClientRpcSchema, MultisigUserOperationContext>>} a promise that resolves to a `SmartAccountClient` object extended with the multisig modular account and additional actions\n */\nexport async function createMultisigModularAccountClient({\n  transport,\n  chain,\n  ...params\n}: CreateMultisigModularAccountClientParams): Promise<\n  | SmartAccountClient<\n      Transport,\n      Chain,\n      MultisigModularAccount<SmartAccountSigner>,\n      {},\n      SmartAccountClientRpcSchema,\n      MultisigUserOperationContext\n    >\n  | AlchemySmartAccountClient<\n      Chain | undefined,\n      MultisigModularAccount<SmartAccountSigner>,\n      MultisigPluginActions<MultisigModularAccount<SmartAccountSigner>> &\n        PluginManagerActions<MultisigModularAccount<SmartAccountSigner>> &\n        AccountLoupeActions<MultisigModularAccount<SmartAccountSigner>>,\n      MultisigUserOperationContext\n    >\n> {\n  const modularAccount = await createMultisigModularAccount({\n    ...params,\n    transport,\n    chain,\n  });\n  if (isAlchemyTransport(transport, chain)) {\n    // Need to fit the type into this since the previous multiSigAlchemyClient had it at this point, but without an Value as Type should be safe\n    // And the createAlchemySmartAccountClient signUserOperation could not infer without this\n    let config: AlchemyMultisigAccountClientConfig = {\n      ...params,\n      chain,\n      transport,\n    };\n    const { opts } = config;\n\n    return createAlchemySmartAccountClient({\n      ...config,\n      account: modularAccount,\n      opts,\n      signUserOperation: multisigSignatureMiddleware,\n    })\n      .extend(smartAccountClientActions)\n      .extend(multisigPluginActions)\n      .extend(pluginManagerActions)\n      .extend(accountLoupeActions);\n  }\n\n  const client = createSmartAccountClient({\n    ...params,\n    transport,\n    chain,\n    account: modularAccount,\n    signUserOperation: multisigSignatureMiddleware,\n  })\n    .extend(smartAccountClientActions)\n    .extend(pluginManagerActions)\n    .extend(multisigPluginActions)\n    .extend(accountLoupeActions);\n\n  return client;\n}\n"]}